document.addEventListener("DOMContentLoaded", () => {
    const audioPlayer = document.getElementById("audioPlayer");
    const videoPlayer = document.getElementById("videoPlayer");
    const nowPlaying = document.getElementById("nowPlaying");
    const playlist = document.getElementById("playlist");
    const recommendations = document.getElementById("recommendations");
    const searchInput = document.getElementById("searchInput");

    // Lista de archivos
    const mediaFiles = [
        { name: "Cancion 1", type: "audio", src: "/static/media/cancion1.mp3" },
        { name: "Cancion 2", type: "audio", src: "/static/media/cancion2.mp3" },
        { name: "Video 1", type: "video", src: "/static/media/video1.mp4" },
        { name: "Video 2", type: "video", src: "/static/media/video2.mp4" }
    ];

    function playMedia(file) {
        if(file.type === "audio") {
            videoPlayer.style.display = "none";
            audioPlayer.style.display = "block";
            audioPlayer.src = file.src;
            audioPlayer.play();
        } else {
            audioPlayer.style.display = "none";
            videoPlayer.style.display = "block";
            videoPlayer.src = file.src;
            videoPlayer.play();
        }
        nowPlaying.textContent = `Reproduciendo: ${file.name}`;
        showRecommendations(file);
    }

    function showRecommendations(currentFile) {
        recommendations.innerHTML = "";
        const suggested = mediaFiles.filter(f => f.name !== currentFile.name);

        if(suggested.length === 0){
            const li = document.createElement("li");
            li.textContent = "No hay recomendaciones";
            recommendations.appendChild(li);
        } else {
            suggested.forEach(f => {
                const li = document.createElement("li");
                li.textContent = f.name;
                li.addEventListener("click", () => playMedia(f));
                recommendations.appendChild(li);
            });
        }
    }

    function loadPlaylist(files) {
        playlist.innerHTML = "";
        files.forEach(file => {
            const li = document.createElement("li");
            li.textContent = file.name;
            li.addEventListener("click", () => playMedia(file));
            playlist.appendChild(li);
        });
    }

    searchInput.addEventListener("input", () => {
        const query = searchInput.value.toLowerCase();
        const filtered = mediaFiles.filter(f => f.name.toLowerCase().includes(query));
        loadPlaylist(filtered);
    });

    loadPlaylist(mediaFiles);
});
